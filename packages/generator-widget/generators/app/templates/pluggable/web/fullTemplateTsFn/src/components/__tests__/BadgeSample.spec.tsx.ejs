import { createElement } from "react";
import { render } from "@testing-library/react";
import userEvent from "@testing-library/user-event";
import "@testing-library/jest-dom";

import { BadgeSample, BadgeSampleProps } from "../BadgeSample";

describe("Badge", () => {
    it("should render the structure", () => {
        const badgeProps: BadgeSampleProps = {
            type: "badge",
            bootstrapStyle: "default",
            value: "0"
        };
        const { container } = render(<BadgeSample {...badgeProps} />);

        const badge = container.querySelector("span.widget-<%- packageName %>.badge.label-default");
        expect(badge).toBeInTheDocument();
        expect(badge).toHaveTextContent("0");
    });

    it("should show value when no value or default value provided", () => {
        const value = "value";
        const { container } = render(<BadgeSample type="label" value={value} defaultValue="default value" />);

        expect(container.querySelector("span")).toHaveTextContent(value);
    });

    it("should show default value when no value is provided", () => {
        const defaultValue = "default";
        const { container } = render(<BadgeSample type="label" value={undefined} defaultValue={defaultValue} />);

        expect(container.querySelector("span")).toHaveTextContent(defaultValue);
    });

    it("should show no value when no value or default value provided", () => {
        const { container } = render(<BadgeSample type="label" value={undefined} />);

        expect(container.querySelector("span")).toHaveTextContent("");
    });

    it("configured as a label should have the class label", () => {
        const { container } = render(<BadgeSample type="label" />);

        expect(container.querySelector("span")).toHaveClass("label");
    });

    it("configured as a badge should have the class badge", () => {
        const { container } = render(<BadgeSample type="badge" />);

        expect(container.querySelector("span")).toHaveClass("badge");
    });

    it("with a click action should respond to click events", async () => {
        const user = userEvent.setup();
        const onClick = jest.fn();
        const { container } = render(<BadgeSample onClickAction={onClick} type="badge" />);

        const badge = container.querySelector("span");
        await user.click(badge!);

        expect(onClick).toHaveBeenCalledTimes(1);
    });

    it("with the Bootstrap style default should have the class label-default", () => {
        const { container } = render(<BadgeSample bootstrapStyle="default" type="badge" />);

        expect(container.querySelector("span")).toHaveClass("label-default");
    });

    it("with the Bootstrap style primary should have the class label-primary", () => {
        const { container } = render(<BadgeSample bootstrapStyle="primary" type="badge" />);

        expect(container.querySelector("span")).toHaveClass("label-primary");
    });

    it("with the Bootstrap style success should have the class label-success", () => {
        const { container } = render(<BadgeSample bootstrapStyle="success" type="badge" />);

        expect(container.querySelector("span")).toHaveClass("label-success");
    });

    it("with the Bootstrap style info should have the class label-info", () => {
        const { container } = render(<BadgeSample bootstrapStyle="info" type="badge" />);

        expect(container.querySelector("span")).toHaveClass("label-info");
    });

    it("with the Bootstrap style warning should have the class label-warning", () => {
        const { container } = render(<BadgeSample bootstrapStyle="warning" type="badge" />);

        expect(container.querySelector("span")).toHaveClass("label-warning");
    });

    it("with the Bootstrap style danger should have the class label-danger", () => {
        const { container } = render(<BadgeSample bootstrapStyle="danger" type="badge" />);

        expect(container.querySelector("span")).toHaveClass("label-danger");
    });
});
